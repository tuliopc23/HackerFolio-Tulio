@import 'tailwindcss';

/* TailwindCSS v4 Theme Configuration */
@theme {
  /* Terminal Base Colors */
  --color-term-bg: #000000;
  --color-term-fg: #f2f4f8;
  --color-term-selection-bg: #393939;
  --color-term-selection-fg: #f2f4f8;
  --color-term-cursor: #ffffff;
  --color-term-cursor-text: #000000;

  /* ANSI Color Palette */
  --color-ansi-0: #161616;
  --color-ansi-1: #78a9ff;
  --color-ansi-2: #ff7eb6;
  --color-ansi-3: #42be65;
  --color-ansi-4: #08bdba;
  --color-ansi-5: #82cfff;
  --color-ansi-6: #33b1ff;
  --color-ansi-7: #dde1e6;
  --color-ansi-8: #393939;
  --color-ansi-9: #78a9ff;
  --color-ansi-10: #ff7eb6;
  --color-ansi-11: #42be65;
  --color-ansi-12: #08bdba;
  --color-ansi-13: #be95ff;
  --color-ansi-14: #33b1ff;
  --color-ansi-15: #ffffff;

  /* Oxocarbon theme colors */
  --color-background: var(--color-term-bg);
  --color-foreground: var(--color-term-fg);
  --color-card: #0a0a0a;
  --color-card-foreground: var(--color-term-fg);
  --color-primary: var(--color-ansi-6);
  --color-primary-foreground: var(--color-term-bg);
  --color-secondary: var(--color-ansi-8);
  --color-secondary-foreground: var(--color-term-fg);
  --color-border: var(--color-ansi-8);

  /* Component-specific colors for compatibility */
  --color-lumon-dark: var(--color-term-bg);
  --color-lumon-bg: #0a0a0a;
  --color-lumon-border: var(--color-ansi-8);
  --color-lumon-text: var(--color-term-fg);
  --color-neon-blue: var(--color-ansi-6);
  --color-cyan-bright: var(--color-ansi-6);
  --color-cyan-soft: var(--color-ansi-5);
  --color-text-cyan: var(--color-term-fg);
  --color-text-soft: #b3e6e6;
  --color-terminal-green: var(--color-ansi-3);
  --color-terminal-orange: #ff8000;
  --color-terminal-red: var(--color-ansi-2);
  --color-magenta-bright: var(--color-ansi-13);
  --color-magenta-soft: var(--color-ansi-2);
  --color-magenta-glow: #ffccf2;

  --radius: 0.5rem;
  --font-mono: 'SF Mono', 'SFMono-Regular', 'Monaspace Neon', 'Courier New', monospace;
}

/* CSS Custom Properties for backwards compatibility */
:root {
  /* Ghostty-inspired Terminal Theme
   * This palette implements a unique ANSI color mapping where traditional
   * color slots are mapped to different hues for a distinctive look:
   * - Red slot (1) → Light blue (#78a9ff)
   * - Green slot (2) → Pink (#ff7eb6)
   * - Yellow slot (3) → Green (#42be65)
   * - Blue slot (4) → Teal (#08bdba)
   * This creates a harmonious, modern terminal aesthetic.
   */

  /* Base Terminal Colors */
  --term-bg: #000000;
  --term-fg: #f2f4f8;
  --term-selection-bg: #393939;
  --term-selection-fg: #f2f4f8;
  --term-cursor: #ffffff;
  --term-cursor-text: #000000;

  /* ANSI 16-Color Palette */
  --ansi-0: #161616; /* black */
  --ansi-1: #78a9ff; /* red slot (mapped to light blue) */
  --ansi-2: #ff7eb6; /* green slot (mapped to pink) */
  --ansi-3: #42be65; /* yellow slot (mapped to green) */
  --ansi-4: #08bdba; /* blue slot (mapped to teal) */
  --ansi-5: #82cfff; /* magenta (light cyan) */
  --ansi-6: #33b1ff; /* cyan (blue) */
  --ansi-7: #dde1e6; /* white */
  --ansi-8: #393939; /* bright black */
  --ansi-9: #78a9ff; /* bright red (same as normal) */
  --ansi-10: #ff7eb6; /* bright green (same as normal) */
  --ansi-11: #42be65; /* bright yellow (same as normal) */
  --ansi-12: #08bdba; /* bright blue (same as normal) */
  --ansi-13: #be95ff; /* bright magenta (purple) */
  --ansi-14: #33b1ff; /* bright cyan (same as normal) */
  --ansi-15: #ffffff; /* bright white */

  /* Oxocarbon theme colors */
  --cyan-bright: var(--ansi-6);
  --cyan-soft: var(--ansi-5);
  --text-cyan: var(--term-fg);
  --text-soft: #b3e6e6;
  --terminal-green: var(--ansi-3);
  --terminal-orange: #ff8000;
  --terminal-red: var(--ansi-2);
  --magenta-bright: var(--ansi-13);
  --magenta-soft: var(--ansi-2);
  --magenta-glow: #ffccf2;

  /* Base tokens */
  --background: var(--term-bg);
  --foreground: var(--term-fg);
  --card: #0a0a0a;
  --card-foreground: var(--term-fg);
  --popover: #0a0a0a;
  --popover-foreground: var(--term-fg);
  --primary: var(--ansi-6);
  --primary-foreground: var(--term-bg);
  --secondary: var(--ansi-8);
  --secondary-foreground: var(--term-fg);
  --muted: var(--ansi-8);
  --muted-foreground: var(--text-soft);
  --accent: var(--ansi-5);
  --accent-foreground: var(--term-bg);
  --destructive: var(--ansi-2);
  --destructive-foreground: var(--term-fg);
  --border: var(--ansi-8);
  --input: #0a0a0a;
  --ring: var(--ansi-6);
  --radius: 0.5rem;
  --font-mono: 'SF Mono', 'SFMono-Regular', 'Courier New', monospace;

  /* Color scheme declaration for proper dark mode */
  color-scheme: dark;
}

.dark {
  --background: var(--term-bg);
  --foreground: var(--term-fg);
}

/* Oxocarbon theme: dark-only app uses oxocarbon tokens */

@layer base {
  /* Self-hosted Monaspace Neon variable font */
  @font-face {
    font-family: 'Monaspace Neon';
    src:
      url('./assets/fonts/monaspace/Monaspace Neon Var.woff2') format('woff2'),
      url('./assets/fonts/monaspace/Monaspace Neon Var.woff') format('woff');
    font-weight: 200 800;
    font-style: normal;
    font-display: swap;
  }

  * {
    border-color: var(--border);
  }

  html,
  body,
  #root {
    min-height: 100vh;
    /* Safari/iOS dynamic viewport units for stable height */
    min-height: 100svh;
    min-height: 100dvh;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: var(--font-mono);
    -webkit-font-smoothing: antialiased;
    background-color: var(--term-bg) !important;
    color: var(--text-cyan);
    overflow: hidden;
  }

  /* Lock body scroll when Ghostty terminal is active */
  body.ghostty-active {
    overflow: hidden;
  }

  #root {
    background-color: var(--term-bg);
    color: var(--text-cyan);
  }
}

@layer components {
  /* Terminal Pane Component Styles */
  .terminal-pane {
    background-color: #0a0a0a;
    border: 1px solid var(--magenta-soft);
    border-radius: var(--radius);
    box-shadow:
      0 0 10px rgba(255, 126, 182, 0.3),
      inset 0 0 10px rgba(255, 126, 182, 0.1);
  }

  .terminal-pane:focus-within,
  .terminal-pane.focused {
    border-color: var(--cyan-bright);
    box-shadow:
      0 0 15px rgba(51, 177, 255, 0.5),
      inset 0 0 15px rgba(51, 177, 255, 0.2);
  }
}

/* CRT Screen Effects */
.crt-screen {
  position: relative;
  background: var(--term-bg);
  isolation: isolate; /* Contain blending/compositing in Safari */
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

.crt-screen::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  /* Scanlines using the bright magenta color */
  background: repeating-linear-gradient(
    0deg,
    rgba(190, 149, 255, 0.03) 0px,
    rgba(190, 149, 255, 0.03) 2px,
    transparent 2px,
    transparent 4px
  );
  z-index: 10;
  /* Use CSS animation instead of opacity changes */
  animation: scanlines 2s ease-in-out infinite;
  will-change: transform; /* Keep only this overlay promoted */
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

.crt-screen::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  background: radial-gradient(ellipse at center, transparent 60%, rgba(10, 15, 28, 0.3) 100%);
  z-index: 11;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

/* Replace opacity-based scanlines with transform */
@keyframes scanlines {
  0% {
    transform: translateZ(0) translateY(0px);
  }
  50% {
    transform: translateZ(0) translateY(2px);
  }
  100% {
    transform: translateZ(0) translateY(0px);
  }
}

.phosphor-glow {
  /* Stronger phosphor glow across app with minimal layers (Safari-friendly) */
  text-shadow:
    0 0 12px currentColor,
    0 0 24px currentColor;
}

.terminal-output {
  text-shadow: 0 0 6px currentColor;
}

.pane-border {
  border: 1px solid var(--magenta-soft);
  /* Pane glow using the pink color from the palette */
  -webkit-box-shadow:
    0 0 10px rgba(255, 126, 182, 0.3),
    inset 0 0 10px rgba(255, 126, 182, 0.1);
  -moz-box-shadow:
    0 0 10px rgba(255, 126, 182, 0.3),
    inset 0 0 10px rgba(255, 126, 182, 0.1);
  box-shadow:
    0 0 10px rgba(255, 126, 182, 0.3),
    inset 0 0 10px rgba(255, 126, 182, 0.1);
}

.pane-focus {
  border-color: var(--cyan-bright);
  /* Focus glow using the cyan color from the palette */
  -webkit-box-shadow:
    0 0 15px rgba(51, 177, 255, 0.5),
    inset 0 0 15px rgba(51, 177, 255, 0.2);
  -moz-box-shadow:
    0 0 15px rgba(51, 177, 255, 0.5),
    inset 0 0 15px rgba(51, 177, 255, 0.2);
  box-shadow:
    0 0 15px rgba(51, 177, 255, 0.5),
    inset 0 0 15px rgba(51, 177, 255, 0.2);
}

/* Utility: multi-line ellipsis without Tailwind plugin */
.multiline-ellipsis-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.multiline-ellipsis-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.cursor-block {
  display: inline-block;
  width: 0.6em;
  height: 1em;
  background-color: var(--magenta-bright);
  /* DISABLED: animation: cursor-blink 1s infinite; */
  margin-left: 2px;
}

/* DISABLED: Cursor blink animation
@keyframes cursor-blink {
  0%,
  50% {
    opacity: 1;
  }
  51%,
  100% {
    opacity: 0;
  }
}
*/

@keyframes scanlines {
  0% {
    transform: translateY(-100%);
  }
  100% {
    transform: translateY(100vh);
  }
}

@keyframes phosphor-glow {
  0% {
    text-shadow:
      0 0 5px currentColor,
      0 0 10px currentColor;
  }
  100% {
    text-shadow:
      0 0 10px currentColor,
      0 0 20px currentColor,
      0 0 30px currentColor;
  }
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #0a0a0a;
}

::-webkit-scrollbar-thumb {
  background: var(--cyan-soft);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--cyan-bright);
}

/* Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
  .crt-screen::before {
    background: none;
  }
  .cursor-block {
    animation: none;
    opacity: 1;
  }
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

.resize-handle {
  width: 4px;
  background: var(--cyan-soft);
  cursor: col-resize;
  opacity: 0.5;
  transition: opacity 0.2s;
}

.resize-handle:hover {
  opacity: 1;
  box-shadow: 0 0 5px var(--cyan-soft);
}

/* Syntax highlighting */
.syntax-keyword {
  color: hsl(198, 89%, 66%);
}
.syntax-string {
  color: hsl(55, 68%, 69%);
}
.syntax-comment {
  color: hsl(50, 11%, 46%);
}
.syntax-function {
  color: hsl(74, 74%, 67%);
}
.syntax-variable {
  color: hsl(0, 0%, 97%);
}

/* Screen Reader Only */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Enhanced Accessibility Focus Styles */
.focus-visible {
  outline: 2px solid var(--cyan-bright);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(51, 177, 255, 0.3);
}

/* High contrast focus for better visibility */
*:focus-visible {
  outline: 2px solid var(--cyan-bright);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(51, 177, 255, 0.3);
}

/* Skip links */
.skip-link {
  position: absolute;
  top: -100px;
  left: 6px;
  padding: 8px 16px;
  background: var(--magenta-bright);
  color: var(--lumon-dark);
  text-decoration: none;
  border-radius: 4px;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  transform: translateY(-100%);
  transition: transform 0.2s ease-in-out;
  border: 2px solid var(--cyan-bright);
  z-index: 1000;
}

.skip-link:focus {
  transform: translateY(100px);
  outline: none;
}

.skip-link:hover {
  background: var(--magenta-soft);
}

/* Focus trap indicator */
.focus-trap-active {
  outline: 3px dashed var(--magenta-bright);
  outline-offset: 2px;
}

/* Enhanced button focus for accessibility */
button:focus-visible,
[role='button']:focus-visible {
  outline: 2px solid var(--cyan-bright);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(51, 177, 255, 0.3);
}

/* Link focus styles */
a:focus-visible {
  outline: 2px solid var(--cyan-bright);
  outline-offset: 2px;
  box-shadow: 0 0 0 2px rgba(51, 177, 255, 0.3);
  border-radius: 2px;
}

/* Input focus enhancement */
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  outline: 2px solid var(--cyan-bright);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(51, 177, 255, 0.3);
  border-color: var(--cyan-bright);
}

/* Status indicators for screen readers */
[role='status'],
[aria-live] {
  border: 1px solid transparent;
}

[role='status']:focus-visible,
[aria-live]:focus-visible {
  border-color: var(--cyan-bright);
  outline: 1px solid var(--cyan-bright);
  outline-offset: 1px;
}

/* Focus management for terminal interface */
.terminal-focused {
  border-color: var(--cyan-bright) !important;
  box-shadow: 0 0 15px rgba(51, 177, 255, 0.5) !important;
}

/* Keyboard navigation hints */
.keyboard-hint {
  border: 1px dashed var(--magenta-soft);
  background: rgba(255, 126, 182, 0.05);
}

/* Reduce motion for accessibility - enhanced */
@media (prefers-reduced-motion: reduce) {
  .crt-screen::before {
    background: none;
  }
  .cursor-block {
    animation: none;
    opacity: 1;
  }
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  .phosphor-glow {
    text-shadow: none;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root {
    --lumon-border: hsl(300, 100%, 30%);
    --cyan-bright: hsl(180, 100%, 60%);
    --magenta-bright: hsl(300, 100%, 70%);
    --terminal-red: hsl(356, 100%, 60%);
    --terminal-green: hsl(120, 100%, 70%);
  }

  .pane-border,
  .pane-focus {
    border-width: 2px;
  }

  *:focus-visible {
    outline-width: 3px;
    box-shadow: 0 0 0 6px rgba(51, 177, 255, 0.5);
  }
}

/* Desktop and Window Animations */
.animate-in {
  animation-fill-mode: both;
}

.fade-in {
  animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Window drag cursor */
.cursor-move {
  cursor: move;
}

/* Desktop icons hover effect */
.desktop-icon:hover {
  background: rgba(255, 126, 182, 0.1);
  transform: translateY(-2px);
}

/* Radial gradient utilities */
.bg-gradient-radial {
  background-image: radial-gradient(circle, var(--tw-gradient-stops));
}

/* WebKit-specific optimizations to reduce rendering overhead */
@supports (-webkit-appearance: none) {
  .crt-screen::before {
    /* Disable expensive scanline animation on WebKit */
    animation: none;
    /* Use a static, simpler gradient */
    background: repeating-linear-gradient(
      0deg,
      rgba(190, 149, 255, 0.02) 0px,
      rgba(190, 149, 255, 0.02) 1px,
      transparent 1px,
      transparent 3px
    );
  }
}

/* ANSI styling support */
.ansi-bold {
  font-weight: 700;
}
.ansi-italic {
  font-style: italic;
}
.ansi-underline {
  text-decoration: underline;
}

/* Foreground colors - using ANSI palette */
.ansi-fg-black {
  color: var(--ansi-0);
}
.ansi-fg-red {
  color: var(--ansi-1);
}
.ansi-fg-green {
  color: var(--ansi-2);
}
.ansi-fg-yellow {
  color: var(--ansi-3);
}
.ansi-fg-blue {
  color: var(--ansi-4);
}
.ansi-fg-magenta {
  color: var(--ansi-5);
}
.ansi-fg-cyan {
  color: var(--ansi-6);
}
.ansi-fg-white {
  color: var(--ansi-7);
}

.ansi-fg-bright-black {
  color: var(--ansi-8);
}
.ansi-fg-bright-red {
  color: var(--ansi-9);
}
.ansi-fg-bright-green {
  color: var(--ansi-10);
}
.ansi-fg-bright-yellow {
  color: var(--ansi-11);
}
.ansi-fg-bright-blue {
  color: var(--ansi-12);
}
.ansi-fg-bright-magenta {
  color: var(--ansi-13);
}
.ansi-fg-bright-cyan {
  color: var(--ansi-14);
}
.ansi-fg-bright-white {
  color: var(--ansi-15);
}

/* Background colors - using ANSI palette */
.ansi-bg-black {
  background-color: var(--ansi-0);
}
.ansi-bg-red {
  background-color: var(--ansi-1);
}
.ansi-bg-green {
  background-color: var(--ansi-2);
}
.ansi-bg-yellow {
  background-color: var(--ansi-3);
}
.ansi-bg-blue {
  background-color: var(--ansi-4);
}
.ansi-bg-magenta {
  background-color: var(--ansi-5);
}
.ansi-bg-cyan {
  background-color: var(--ansi-6);
}
.ansi-bg-white {
  background-color: var(--ansi-7);
}

.ansi-bg-bright-black {
  background-color: var(--ansi-8);
}
.ansi-bg-bright-red {
  background-color: var(--ansi-9);
}
.ansi-bg-bright-green {
  background-color: var(--ansi-10);
}
.ansi-bg-bright-yellow {
  background-color: var(--ansi-11);
}
.ansi-bg-bright-blue {
  background-color: var(--ansi-12);
}
.ansi-bg-bright-magenta {
  background-color: var(--ansi-13);
}
.ansi-bg-bright-cyan {
  background-color: var(--ansi-14);
}
.ansi-bg-bright-white {
  background-color: var(--ansi-15);
}

/* Global selection styling */
::selection {
  background-color: var(--term-selection-bg);
  color: var(--term-selection-fg);
}

/* Terminal cursor and caret styling */
.terminal,
.terminal * {
  caret-color: var(--term-cursor);
}

.terminal .cursor,
.cursor-block {
  background-color: var(--term-cursor);
  color: var(--term-cursor-text);
}

/* Typewriter and animation effects */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* DISABLED: Typewriter animation
@keyframes typewriter {
  from {
    width: 0;
  }
  to {
    width: 100%;
  }
}
*/

/* OPTIMIZATION: Add CSS optimizations for better performance */

/* Improve font loading performance: SF Mono is loaded via CDN in index.html */

/* Optimize animations for better performance */
.fade-in-up {
  animation: fadeInUp 0.6s ease-out forwards;
}

/* Avoid global will-change to reduce Safari layer explosion */

/* Optimize terminal rendering */
.terminal-output {
  contain: layout style;
}

.typing-effect {
  /* DISABLED: animation: typewriter 2s steps(20, end); */
  overflow: hidden;
  white-space: nowrap;
  /* DISABLED: border-right: 2px solid var(--color-cyan-bright); */
}

/* Utility: contain paint for compositing isolation */
.contain-paint {
  contain: paint;
}

/* iOS Safari inertial scrolling for overflow containers */
.ios-inertia {
  -webkit-overflow-scrolling: touch;
}

/* Route page rendering containment for WebKit (and others that support it) */
@supports (content-visibility: auto) {
  .route-page {
    content-visibility: auto;
    contain-intrinsic-size: 1200px 800px;
  }
}

/* Utility: apply content-visibility to scrollable panes without changing visuals */
@supports (content-visibility: auto) {
  .content-visibility-auto {
    content-visibility: auto;
    contain-intrinsic-size: 800px 600px;
  }
}

/* Utility: stabilize compositing for heavy wrappers (use sparingly) */
.composite-layer {
  transform: translateZ(0);
}

/* Guarded Safari-only tweaks example (kept minimal) */
@supports (-webkit-hyphens: none) and (not (hyphens: none)) {
  /* WebKit-specific compositor nudge without affecting Blink/Gecko */
  .crt-screen::before {
    will-change: transform;
  }
}
